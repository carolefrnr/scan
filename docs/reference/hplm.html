<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hierarchical piecewise linear model / piecewise regression — hplm • scan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Hierarchical piecewise linear model / piecewise regression — hplm"><meta property="og:description" content="The hplm function computes a hierarchical piecewise regression model."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.54.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://jazznbass.github.io/scan-Book/" class="external-link">The book</a>
</li>
<li>
  <a href="https://jazznbass.github.io/scplot/" class="external-link">scplot</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jazznbass/scan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hierarchical piecewise linear model / piecewise regression</h1>
    <small class="dont-index">Source: <a href="https://github.com/jazznbass/scan/blob/HEAD/R/hplm.R" class="external-link"><code>R/hplm.R</code></a></small>
    <div class="hidden name"><code>hplm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>hplm</code> function computes a hierarchical piecewise regression model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">hplm</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">dvar</span>,
  <span class="va">pvar</span>,
  <span class="va">mvar</span>,
  model <span class="op">=</span> <span class="st">"W"</span>,
  contrast <span class="op">=</span> <span class="st">"first"</span>,
  method <span class="op">=</span> <span class="st">"ML"</span>,
  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>opt <span class="op">=</span> <span class="st">"optim"</span><span class="op">)</span>,
  random.slopes <span class="op">=</span> <span class="cn">FALSE</span>,
  lr.test <span class="op">=</span> <span class="cn">FALSE</span>,
  ICC <span class="op">=</span> <span class="cn">TRUE</span>,
  trend <span class="op">=</span> <span class="cn">TRUE</span>,
  level <span class="op">=</span> <span class="cn">TRUE</span>,
  slope <span class="op">=</span> <span class="cn">TRUE</span>,
  fixed <span class="op">=</span> <span class="cn">NULL</span>,
  random <span class="op">=</span> <span class="cn">NULL</span>,
  update.fixed <span class="op">=</span> <span class="cn">NULL</span>,
  data.l2 <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A single-case data frame. See <code><a href="scdf.html">scdf</a></code> to learn about
this format.</p></dd>
<dt>dvar</dt>
<dd><p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p></dd>
<dt>pvar</dt>
<dd><p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p></dd>
<dt>mvar</dt>
<dd><p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p></dd>
<dt>model</dt>
<dd><p>Model used for calculating the slope parameter (see Huitema &amp;
McKean, 2000). Default is <code>model = "W"</code>. Possible values are:
<code>"B&amp;L-B"</code>, <code>"H-M"</code>, <code>"W"</code>, and deprecated <code>"JW"</code>.</p></dd>
<dt>contrast</dt>
<dd><p>Either "first" or "preceding". "first" contrasts all 
phase-effects to the first phase and "preceding" to the preceding phase.</p></dd>
<dt>method</dt>
<dd><p>Method used to fit your model. Pass <code>"REML"</code> to maximize
the restricted log-likelihood or <code>"ML"</code> for maximized log-likelihood.
Default is <code>"ML"</code>.</p></dd>
<dt>control</dt>
<dd><p>A list of settings for the estimation algorithm, replacing
the default values passed to the function <code>lmeControl</code> of the
<code>nlme</code> package.</p></dd>
<dt>random.slopes</dt>
<dd><p>If <code>random.slopes = TRUE</code> random slope effects of
the level, trend, and treatment parameter are estimated.</p></dd>
<dt>lr.test</dt>
<dd><p>If set TRUE likelihood ratio tests are calculated comparing model with vs. without random slope parameters.</p></dd>
<dt>ICC</dt>
<dd><p>If <code>ICC = TRUE</code> an intraclass-correlation is estimated.</p></dd>
<dt>trend</dt>
<dd><p>A logical indicating if a trend parameters is included in the
model.</p></dd>
<dt>level</dt>
<dd><p>A logical indicating if a level parameters is included in the
model.</p></dd>
<dt>slope</dt>
<dd><p>A logical indicating if a slope parameters is included in the
model.</p></dd>
<dt>fixed</dt>
<dd><p>Defaults to the fixed part of the standard piecewise regression model. The
parameter phase followed by the phase name (e.g., phaseB) indicates the level effect of the corresponding phase. The parameter 'inter' followed by the phase name (e.g., interB) adresses the slope effect based on the method
provide in the model argument (e.g., "B&amp;L-B"). The formula can be changed
for example to include further L1 or L2 variables into the regression model.</p></dd>
<dt>random</dt>
<dd><p>The random part of the model.</p></dd>
<dt>update.fixed</dt>
<dd><p>An easier way to change the fixed model part (e.g., . ~ . + newvariable).</p></dd>
<dt>data.l2</dt>
<dd><p>A dataframe providing additional variables at Level 2. The
scdf File has to have names for all cases and the Level 2 dataframe has to
have a column named 'cases' with the names of the cases the Level 2
variables belong to.</p></dd>
<dt>...</dt>
<dd><p>Further arguments passed to the lme function.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>model</dt>
<dd><p>List containing infromation about the applied model</p></dd>
<dt>N</dt>
<dd><p>Number of single-cases.</p></dd>
<dt>formla</dt>
<dd><p>A list containing the fixed and the random formulas of the hplm model.</p></dd>
<dt>hplm</dt>
<dd><p>Object of class lme contaning the multilevel model</p></dd>
<dt>model.0</dt>
<dd><p>Object of class lme containing the Zero Model.</p></dd>
<dt>ICC</dt>
<dd><p>List containing intraclass correlation and test parameters.</p></dd>
<dt>model.without</dt>
<dd><p>Object of class gls containing the fixed effect model.</p></dd>
</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other regression functions: 
<code><a href="corrected_tau.html">corrected_tau</a>()</code>,
<code><a href="mplm.html">mplm</a>()</code>,
<code><a href="plm.html">plm</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Juergen Wilbert</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Compute hplm model on a MBD over fifty cases (restricted log-likelihood)</span></span>
<span class="r-in"><span class="fu">hplm</span><span class="op">(</span><span class="va">exampleAB_50</span>, method <span class="op">=</span> <span class="st">"REML"</span>, random.slopes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hierarchical Piecewise Linear Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method REML </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model: W first</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ICC = 0.292; L = 341.2; p = 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects (values ~ 1 + mt + phaseB + interB)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    B    SE   df      t p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     48.398 1.496 1328 32.351 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt       0.579 0.116 1328  5.007 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B 14.038 0.655 1328 21.442 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B  0.902 0.119 1328  7.589 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects (~1 | case)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           EstimateSD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     10.073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual       5.290</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Analyzing with additional L2 variables</span></span>
<span class="r-in"><span class="fu">hplm</span><span class="op">(</span><span class="va">Leidig2018</span>, data.l2 <span class="op">=</span> <span class="va">Leidig2018_l2</span>, </span>
<span class="r-in">     update.fixed <span class="op">=</span> <span class="va">.</span><span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">migration</span> <span class="op">+</span> <span class="va">ITRF_TOTAL</span><span class="op">*</span><span class="va">phaseB</span>, </span>
<span class="r-in">     slope <span class="op">=</span> <span class="cn">FALSE</span>, random.slopes <span class="op">=</span> <span class="cn">FALSE</span>, lr.test <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hierarchical Piecewise Linear Regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method ML </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model: W first</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ICC = 0.344; L = 875.4; p = 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects (academic_engagement ~ mt + phaseB + gender + migration + ITRF_TOTAL +     phaseB:ITRF_TOTAL)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               B    SE   df      t     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept                 3.751 0.262 2376 14.302 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt                  0.004 0.001 2376  6.019 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B             0.667 0.098 2376  6.808 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gender                   -0.020 0.301   31 -0.067 0.947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> migration                -0.300 0.193   31 -1.556 0.130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ITRF_TOTAL               -0.035 0.013   31 -2.674 0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B:ITRF_TOTAL -0.001 0.005 2376 -0.279 0.780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects (~1 | case)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           EstimateSD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept      0.557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual       0.785</span>
<span class="r-in">     </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

