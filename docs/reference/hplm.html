<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Hierarchical piecewise linear model / piecewise regression — hplm • scan</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Hierarchical piecewise linear model / piecewise regression — hplm" />
<meta property="og:description" content="The hplm function computes a hierarchical piecewise regression model." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.54</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jazznbass/scan/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hierarchical piecewise linear model / piecewise regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/jazznbass/scan/blob/master/R/hplm.R'><code>R/hplm.R</code></a></small>
    <div class="hidden name"><code>hplm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>hplm</code> function computes a hierarchical piecewise regression model.</p>
    </div>

    <pre class="usage"><span class='fu'>hplm</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>dvar</span>,
  <span class='va'>pvar</span>,
  <span class='va'>mvar</span>,
  model <span class='op'>=</span> <span class='st'>"B&amp;L-B"</span>,
  method <span class='op'>=</span> <span class='st'>"ML"</span>,
  control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>opt <span class='op'>=</span> <span class='st'>"optim"</span><span class='op'>)</span>,
  random.slopes <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lr.test <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ICC <span class='op'>=</span> <span class='cn'>TRUE</span>,
  trend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  level <span class='op'>=</span> <span class='cn'>TRUE</span>,
  slope <span class='op'>=</span> <span class='cn'>TRUE</span>,
  fixed <span class='op'>=</span> <span class='cn'>NULL</span>,
  random <span class='op'>=</span> <span class='cn'>NULL</span>,
  update.fixed <span class='op'>=</span> <span class='cn'>NULL</span>,
  data.l2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A single-case data frame. See <code><a href='scdf.html'>scdf</a></code> to learn about this format.</p></td>
    </tr>
    <tr>
      <th>dvar</th>
      <td><p>Character string with the name of the dependent variable. Defaults to the attributes in the scdf file.</p></td>
    </tr>
    <tr>
      <th>pvar</th>
      <td><p>Character string with the name of the phase variable. Defaults to the attributes in the scdf file.</p></td>
    </tr>
    <tr>
      <th>mvar</th>
      <td><p>Character string with the name of the measurement time variable. Defaults to the attributes in the scdf file.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Model used for calculating the slope parameter (see Huitema &amp;
McKean, 2000). Default is <code>model = "B&amp;L-B"</code>. Possible values are:
<code>"B&amp;L-B"</code>, <code>"H-M"</code>, <code>"Mohr#1"</code>, <code>"Mohr#2"</code>, <code>"JW"</code>, <code>"JW2"</code>, and
<code>"Manly"</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method used to fit your model. Pass <code>"REML"</code> to maximize
the restricted log-likelihood or <code>"ML"</code> for maximized log-likelihood.
Default is <code>"ML"</code>.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of settings for the estimation algorithm, replacing
the default values passed to the function <code>lmeControl</code> of the
<code>nlme</code> package.</p></td>
    </tr>
    <tr>
      <th>random.slopes</th>
      <td><p>If <code>random.slopes = TRUE</code> random slope effects of
the level, trend, and treatment parameter are estimated.</p></td>
    </tr>
    <tr>
      <th>lr.test</th>
      <td><p>If set TRUE likelihood ratio tests are calculated comparing model with vs. without random slope parameters.</p></td>
    </tr>
    <tr>
      <th>ICC</th>
      <td><p>If <code>ICC = TRUE</code> an intraclass-correlation is estimated.</p></td>
    </tr>
    <tr>
      <th>trend</th>
      <td><p>A logical indicating if a trend parameters is included in the model.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>A logical indicating if a level parameters is included in the model.</p></td>
    </tr>
    <tr>
      <th>slope</th>
      <td><p>A logical indicating if a slope parameters is included in the model.</p></td>
    </tr>
    <tr>
      <th>fixed</th>
      <td><p>Defaults to the fixed part of the standard piecewise regression model. The
parameter phase followed by the phase name (e.g., phaseB) indicates the level effect of the corresponding phase. The parameter 'inter' followed by the phase name (e.g., interB) adresses the slope effect based on the method
provide in the model argument (e.g., "B&amp;L-B"). The formula can be changed
for example to include further L1 or L2 variables into the regression model.</p></td>
    </tr>
    <tr>
      <th>random</th>
      <td><p>The random part of the model.</p></td>
    </tr>
    <tr>
      <th>update.fixed</th>
      <td><p>An easier way to change the fixed model part (e.g., . ~ . + newvariable).</p></td>
    </tr>
    <tr>
      <th>data.l2</th>
      <td><p>A dataframe providing additional variables at Level 2. The
scdf File has to have names for all cases and the Level 2 dataframe has to
have a column named 'cases' with the names of the cases the Level 2
variables belong to.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the lme function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>model</dt><dd><p>List containing infromation about the applied model</p></dd> 
<dt>N</dt><dd><p>Number of single-cases.</p></dd>
<dt>formla</dt><dd><p>A list containing the fixed and the random formulas of the hplm model.</p></dd>
<dt>hplm</dt><dd><p>Object of class lme contaning the multilevel model</p></dd> 
<dt>model.0</dt><dd><p>Object of class lme containing the Zero Model.</p></dd> 
<dt>ICC</dt><dd><p>List containing intraclass correlation and test parameters.</p></dd>
<dt>model.without</dt><dd><p>Object of class gls containing the fixed effect model.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other regression functions: 
<code><a href='corrected_tau.html'>corrected_tau</a>()</code>,
<code><a href='mplm.html'>mplm</a>()</code>,
<code><a href='plm.html'>plm</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Juergen Wilbert</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Compute hplm model on a MBD over fifty cases (restricted log-likelihood)</span>
<span class='fu'>hplm</span><span class='op'>(</span><span class='va'>exampleAB_50</span>, method <span class='op'>=</span> <span class='st'>"REML"</span>, random.slopes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Hierarchical Piecewise Linear Regression
#&gt; 
#&gt; Estimation method REML 
#&gt; Slope estimation method: B&amp;L-B 
#&gt; 50 Cases
#&gt; 
#&gt; ICC = 0.199; L = 193.8; p = 0.000
#&gt; 
#&gt; Fixed effects (values ~ 1 + mt + phaseB + interB)
#&gt; 
#&gt;                    B    SE   df      t p
#&gt; Intercept     51.615 1.291 1281 39.982 0
#&gt; Trend mt       0.671 0.115 1281  5.843 0
#&gt; Level phase B 12.939 0.589 1281 21.950 0
#&gt; Slope phase B  0.860 0.119 1281  7.240 0
#&gt; 
#&gt; Random effects (~1 | case)
#&gt; 
#&gt;           EstimateSD
#&gt; Intercept      8.265
#&gt; Residual       5.342</div><div class='input'>
<span class='co'>## Analyzing with additional L2 variables</span>
<span class='fu'>hplm</span><span class='op'>(</span><span class='va'>Leidig2018</span>, data.l2 <span class='op'>=</span> <span class='va'>Leidig2018_l2</span>, 
     update.fixed <span class='op'>=</span> <span class='va'>.</span><span class='op'>~</span><span class='va'>.</span> <span class='op'>+</span> <span class='va'>gender</span> <span class='op'>+</span> <span class='va'>migration</span> <span class='op'>+</span> <span class='va'>ITRF_TOTAL</span><span class='op'>*</span><span class='va'>phaseB</span>, 
     slope <span class='op'>=</span> <span class='cn'>FALSE</span>, random.slopes <span class='op'>=</span> <span class='cn'>FALSE</span>, lr.test <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Hierarchical Piecewise Linear Regression
#&gt; 
#&gt; Estimation method ML 
#&gt; Slope estimation method: B&amp;L-B 
#&gt; 35 Cases
#&gt; 
#&gt; ICC = 0.344; L = 875.4; p = 0.000
#&gt; 
#&gt; Fixed effects (academic_engagement ~ mt + phaseB + gender + migration + ITRF_TOTAL +     phaseB:ITRF_TOTAL)
#&gt; 
#&gt;                               B    SE   df      t     p
#&gt; Intercept                 3.747 0.262 2376 14.285 0.000
#&gt; Trend mt                  0.004 0.001 2376  6.019 0.000
#&gt; Level phase B             0.667 0.098 2376  6.808 0.000
#&gt; gender                   -0.020 0.301   31 -0.067 0.947
#&gt; migration                -0.300 0.193   31 -1.556 0.130
#&gt; ITRF_TOTAL               -0.035 0.013   31 -2.674 0.012
#&gt; Level phase B:ITRF_TOTAL -0.001 0.005 2376 -0.279 0.780
#&gt; 
#&gt; Random effects (~1 | case)
#&gt; 
#&gt;           EstimateSD
#&gt; Intercept      0.557
#&gt; Residual       0.785</div><div class='input'>     
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


