<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Piecewise linear model / piecewise regression — plm • scan</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Piecewise linear model / piecewise regression — plm" />
<meta property="og:description" content="The plm function computes a piecewise regression model (see Huitema &amp;amp;
McKean, 2000)." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.53.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://jazznbass.github.io/scan-Book/">The book</a>
</li>
<li>
  <a href="https://jazznbass.github.io/scplot/">scplot</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jazznbass/scan/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Piecewise linear model / piecewise regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/jazznbass/scan/blob/master/R/plm.R'><code>R/plm.R</code></a></small>
    <div class="hidden name"><code>plm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>plm</code> function computes a piecewise regression model (see Huitema &amp;
McKean, 2000).</p>
    </div>

    <pre class="usage"><span class='fu'>plm</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>dvar</span>,
  <span class='va'>pvar</span>,
  <span class='va'>mvar</span>,
  AR <span class='op'>=</span> <span class='fl'>0</span>,
  model <span class='op'>=</span> <span class='st'>"B&amp;L-B"</span>,
  family <span class='op'>=</span> <span class='st'>"gaussian"</span>,
  trend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  level <span class='op'>=</span> <span class='cn'>TRUE</span>,
  slope <span class='op'>=</span> <span class='cn'>TRUE</span>,
  formula <span class='op'>=</span> <span class='cn'>NULL</span>,
  update <span class='op'>=</span> <span class='cn'>NULL</span>,
  na.action <span class='op'>=</span> <span class='va'>na.omit</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A single-case data frame. See <code><a href='scdf.html'>scdf</a></code> to learn about this format.</p></td>
    </tr>
    <tr>
      <th>dvar</th>
      <td><p>Character string with the name of the dependent variable. Defaults to the attributes in the scdf file.</p></td>
    </tr>
    <tr>
      <th>pvar</th>
      <td><p>Character string with the name of the phase variable. Defaults to the attributes in the scdf file.</p></td>
    </tr>
    <tr>
      <th>mvar</th>
      <td><p>Character string with the name of the measurement time variable. Defaults to the attributes in the scdf file.</p></td>
    </tr>
    <tr>
      <th>AR</th>
      <td><p>Maximal lag of autoregression. Modeled based on the
Autoregressive-Moving Average (ARMA) function.  When AR is set, the family
argument must be set to <code>family = "gaussian"</code>.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Model used for calculating the slope parameter (see Huitema &amp;
McKean, 2000). Default is <code>model = "B&amp;L-B"</code>. Possible values are:
<code>"B&amp;L-B"</code>, <code>"H-M"</code>, <code>"Mohr#1"</code>, <code>"Mohr#2"</code>, <code>"JW"</code>, <code>"JW2"</code>, and
<code>"Manly"</code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Set the distributioin family. Defaults to a gaussian
distribution. See the <code>family</code> function for more details.</p></td>
    </tr>
    <tr>
      <th>trend</th>
      <td><p>A logical indicating if a trend parameters is included in the model.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>A logical indicating if a level parameters is included in the model.</p></td>
    </tr>
    <tr>
      <th>slope</th>
      <td><p>A logical indicating if a slope parameters is included in the model.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>Defaults to the standard piecewise regression model. The
parameter phase followed by the phase name (e.g., phaseB) indicates the level effect of the corresponding phase. The parameter 'inter' followed by the phase name (e.g., interB) adresses the slope effect based on the method
provide in the model argument (e.g., "B&amp;L-B"). The formula can be changed
for example to include further variables into the regression model.</p></td>
    </tr>
    <tr>
      <th>update</th>
      <td><p>An easier way to change the regression formula (e.g., . ~ . + newvariable).</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>Defines how to deal with missing values</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the glm function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>formula</dt><dd><p>plm formula. Uselful if you want to use the update or formula argument and you don't know the names of the parameters.</p></dd>
<dt>model</dt><dd><p>Character string from function call (see <code>Arguments</code> above).</p></dd> 
<dt>F.test</dt><dd><p>F-test values of modelfit.</p></dd>
<dt>r.squares</dt><dd><p>Explained variance R squared for each model parameter.</p></dd>
<dt>ar</dt><dd><p>Autoregression lag from function call (see <code>Arguments</code> above).</p></dd>
<dt>family</dt><dd><p>Distribution family from function call (see <code>Arguments</code> above).</p></dd>
<dt>full.model</dt><dd><p>Full regression model list from the gls or glm function.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Beretvas, S., &amp; Chung, H. (2008). An evaluation of modified
R2-change effect size indices for single-subject experimental designs.
<em>Evidence-Based Communication Assessment and Intervention, 2</em>, 120-128.</p>
<p>Huitema, B. E., &amp; McKean, J. W. (2000). Design specification issues in
time-series intervention models. <em>Educational and Psychological
Measurement, 60</em>, 38-58.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other regression functions: 
<code><a href='corrected_tau.html'>corrected_tau</a>()</code>,
<code><a href='hplm.html'>hplm</a>()</code>,
<code><a href='mplm.html'>mplm</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Juergen Wilbert</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Compute a piecewise regression model for a random single-case</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>AB</span> <span class='op'>&lt;-</span> <span class='fu'><a href='random.html'>design_rSC</a></span><span class='op'>(</span>
  phase.design <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>10</span>, B <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>, 
  level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>0</span>, B <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A <span class='op'>=</span> <span class='fl'>0</span>, B <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>, 
  trend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='random.html'>rSC</a></span><span class='op'>(</span>design <span class='op'>=</span> <span class='va'>AB</span><span class='op'>)</span>
<span class='fu'>plm</span><span class='op'>(</span><span class='va'>dat</span>, AR <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Piecewise Regression Analysis
#&gt; 
#&gt; Dummy model:  B&amp;L-B 
#&gt; 
#&gt; Fitted a gaussian distribution.
#&gt; Correlated residuals up to autoregressions of lag 3 are modelled
#&gt; 
#&gt; F(3, 26) = 47.38; p = 0.000; R² = 0.845; Adjusted R² = 0.828
#&gt; 
#&gt;                    B   2.5%  97.5%    SE      t     p delta R²
#&gt; Intercept     53.234 47.630 58.838 2.859 18.618 0.000         
#&gt; Trend mt      -0.166 -1.032  0.701 0.442 -0.374 0.711  -0.0012
#&gt; Level phase B 15.353  9.550 21.156 2.961  5.185 0.000   0.0735
#&gt; Slope phase B  0.913 -0.045  1.871 0.489  1.869 0.073   0.0162
#&gt; 
#&gt; Autocorrelations of the residuals
#&gt;  lag    cr
#&gt;    1 -0.12
#&gt;    2 -0.23
#&gt;    3  0.38
#&gt; 
#&gt; Formula: values ~ 1 + mt + phaseB + interB
#&gt; </div><div class='input'>
<span class='co'>## Another example with a more complex design</span>
<span class='va'>A1B1A2B2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='random.html'>design_rSC</a></span><span class='op'>(</span>
  phase.design <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A1 <span class='op'>=</span> <span class='fl'>15</span>, B1 <span class='op'>=</span> <span class='fl'>20</span>, A2 <span class='op'>=</span> <span class='fl'>15</span>, B2 <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>, 
  level <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A1 <span class='op'>=</span> <span class='fl'>0</span>, B1 <span class='op'>=</span> <span class='fl'>1</span>, A2 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>, B2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
  slope <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>A1 <span class='op'>=</span> <span class='fl'>0</span>, B1 <span class='op'>=</span> <span class='fl'>0.0</span>, A1 <span class='op'>=</span> <span class='fl'>0</span>, B2 <span class='op'>=</span> <span class='fl'>0.0</span><span class='op'>)</span>,
  trend <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>0.0</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='random.html'>rSC</a></span><span class='op'>(</span>design <span class='op'>=</span> <span class='va'>A1B1A2B2</span>, seed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span>
<span class='fu'>plm</span><span class='op'>(</span><span class='va'>dat</span>, model <span class='op'>=</span> <span class='st'>"JW"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Piecewise Regression Analysis
#&gt; 
#&gt; Dummy model:  JW 
#&gt; 
#&gt; Fitted a gaussian distribution.
#&gt; F(7, 62) = 11.05; p = 0.000; R² = 0.555; Adjusted R² = 0.505
#&gt; 
#&gt;                      B    2.5%  97.5%    SE      t     p delta R²
#&gt; Intercept       51.439  46.427 56.451 2.557 20.115 0.000         
#&gt; Trend mt        -0.085  -0.636  0.467 0.281 -0.301 0.764   0.0006
#&gt; Level phase B1   7.536   1.297 13.775 3.183  2.367 0.021   0.0402
#&gt; Level phase A2 -11.120 -17.517 -4.722 3.264 -3.407 0.001   0.0833
#&gt; Level phase B2  10.261   4.022 16.500 3.183  3.224 0.002   0.0746
#&gt; Slope phase B1   0.280  -0.377  0.937 0.335  0.835 0.407   0.0050
#&gt; Slope phase A2  -0.240  -0.897  0.417 0.335 -0.716 0.477   0.0037
#&gt; Slope phase B2   0.119  -0.538  0.776 0.335  0.354 0.724   0.0009
#&gt; 
#&gt; Autocorrelations of the residuals
#&gt;  lag    cr
#&gt;    1 -0.05
#&gt;    2 -0.12
#&gt;    3  0.12
#&gt; 
#&gt; Formula: values ~ 1 + mt + phaseB1 + phaseA2 + phaseB2 + interB1 + interA2 + 
#&gt;     interB2
#&gt; </div><div class='input'>
<span class='co'>## no slope effects were found. Therefore you might want to drop slope estimation:</span>
<span class='fu'>plm</span><span class='op'>(</span><span class='va'>dat</span>, slope <span class='op'>=</span> <span class='cn'>FALSE</span>, model <span class='op'>=</span> <span class='st'>"JW"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Piecewise Regression Analysis
#&gt; 
#&gt; Dummy model:  JW 
#&gt; 
#&gt; Fitted a gaussian distribution.
#&gt; F(4, 65) = 19.73; p = 0.000; R² = 0.548; Adjusted R² = 0.521
#&gt; 
#&gt;                      B    2.5%  97.5%    SE      t     p delta R²
#&gt; Intercept       50.157  47.279 53.035 1.468 34.157 0.000         
#&gt; Trend mt         0.076  -0.133  0.284 0.107  0.710 0.480   0.0035
#&gt; Level phase B1   7.671   2.879 12.463 2.445  3.137 0.003   0.0684
#&gt; Level phase A2 -10.945 -15.737 -6.153 2.445 -4.477 0.000   0.1392
#&gt; Level phase B2   9.402   4.610 14.194 2.445  3.846 0.000   0.1028
#&gt; 
#&gt; Autocorrelations of the residuals
#&gt;  lag    cr
#&gt;    1 -0.03
#&gt;    2 -0.09
#&gt;    3  0.13
#&gt; 
#&gt; Formula: values ~ 1 + mt + phaseB1 + phaseA2 + phaseB2
#&gt; </div><div class='input'>
<span class='co'>## and now drop the trend estimation as well</span>
<span class='fu'>plm</span><span class='op'>(</span><span class='va'>dat</span>, slope <span class='op'>=</span> <span class='cn'>FALSE</span>, trend <span class='op'>=</span> <span class='cn'>FALSE</span>, model <span class='op'>=</span> <span class='st'>"JW"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Piecewise Regression Analysis
#&gt; 
#&gt; Dummy model:  JW 
#&gt; 
#&gt; Fitted a gaussian distribution.
#&gt; F(3, 66) = 26.34; p = 0.000; R² = 0.545; Adjusted R² = 0.524
#&gt; 
#&gt;                     B    2.5%  97.5%    SE      t p delta R²
#&gt; Intercept      50.762  48.427 53.097 1.191 42.611 0         
#&gt; Level phase B1  8.995   5.906 12.084 1.576  5.708 0   0.2247
#&gt; Level phase A2 -9.621 -12.710 -6.532 1.576 -6.105 0   0.2570
#&gt; Level phase B2 10.726   7.637 13.815 1.576  6.806 0   0.3195
#&gt; 
#&gt; Autocorrelations of the residuals
#&gt;  lag    cr
#&gt;    1 -0.01
#&gt;    2 -0.08
#&gt;    3  0.13
#&gt; 
#&gt; Formula: values ~ 1 + phaseB1 + phaseA2 + phaseB2
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


