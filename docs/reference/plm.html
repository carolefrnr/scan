<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Piecewise linear model / piecewise regression — plm • scan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Piecewise linear model / piecewise regression — plm"><meta property="og:description" content="The plm function computes a piecewise regression model (see Huitema &amp;amp;
McKean, 2000)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.54</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://jazznbass.github.io/scan-Book/" class="external-link">The book</a>
</li>
<li>
  <a href="https://jazznbass.github.io/scplot/" class="external-link">scplot</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jazznbass/scan/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Piecewise linear model / piecewise regression</h1>
    <small class="dont-index">Source: <a href="https://github.com/jazznbass/scan/blob/HEAD/R/plm.R" class="external-link"><code>R/plm.R</code></a></small>
    <div class="hidden name"><code>plm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>plm</code> function computes a piecewise regression model (see Huitema &amp;
McKean, 2000).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plm</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">dvar</span>,
  <span class="va">pvar</span>,
  <span class="va">mvar</span>,
  AR <span class="op">=</span> <span class="fl">0</span>,
  model <span class="op">=</span> <span class="st">"B&amp;L-B"</span>,
  family <span class="op">=</span> <span class="st">"gaussian"</span>,
  trend <span class="op">=</span> <span class="cn">TRUE</span>,
  level <span class="op">=</span> <span class="cn">TRUE</span>,
  slope <span class="op">=</span> <span class="cn">TRUE</span>,
  formula <span class="op">=</span> <span class="cn">NULL</span>,
  update <span class="op">=</span> <span class="cn">NULL</span>,
  na.action <span class="op">=</span> <span class="va">na.omit</span>,
  r_squared <span class="op">=</span> <span class="cn">TRUE</span>,
  var_trials <span class="op">=</span> <span class="cn">NULL</span>,
  dvar_percentage <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A single-case data frame. See <code><a href="scdf.html">scdf</a></code> to learn about
this format.</p></dd>
<dt>dvar</dt>
<dd><p>Character string with the name of the dependent variable.
Defaults to the attributes in the scdf file.</p></dd>
<dt>pvar</dt>
<dd><p>Character string with the name of the phase variable. Defaults to
the attributes in the scdf file.</p></dd>
<dt>mvar</dt>
<dd><p>Character string with the name of the measurement time variable.
Defaults to the attributes in the scdf file.</p></dd>
<dt>AR</dt>
<dd><p>Maximal lag of autoregression. Modeled based on the
Autoregressive-Moving Average (ARMA) function.  When AR is set, the family
argument must be set to <code>family = "gaussian"</code>.</p></dd>
<dt>model</dt>
<dd><p>Model used for calculating the slope parameter (see Huitema &amp;
McKean, 2000). Default is <code>model = "B&amp;L-B"</code>. Possible values are:
<code>"B&amp;L-B"</code>, <code>"H-M"</code>, <code>"Mohr#1"</code>, <code>"Mohr#2"</code>,
<code>"JW"</code>, <code>"JW2"</code>, and <code>"Manly"</code>.</p></dd>
<dt>family</dt>
<dd><p>Set the distribution family. Defaults to a gaussian
distribution. See the <code>family</code> function for more details.</p></dd>
<dt>trend</dt>
<dd><p>A logical indicating if a trend parameters is included in the
model.</p></dd>
<dt>level</dt>
<dd><p>A logical indicating if a level parameters is included in the
model.</p></dd>
<dt>slope</dt>
<dd><p>A logical indicating if a slope parameters is included in the
model.</p></dd>
<dt>formula</dt>
<dd><p>Defaults to the standard piecewise regression model. The
parameter phase followed by the phase name (e.g., phaseB) indicates the 
level effect of the corresponding phase. The parameter 'inter' followed by 
the phase name (e.g., interB) adresses the slope effect based on the method
provide in the model argument (e.g., "B&amp;L-B"). The formula can be changed
for example to include further variables into the regression model.</p></dd>
<dt>update</dt>
<dd><p>An easier way to change the regression formula 
(e.g., . ~ . + newvariable).</p></dd>
<dt>na.action</dt>
<dd><p>Defines how to deal with missing values.</p></dd>
<dt>r_squared</dt>
<dd><p>Logical. If TRUE, delta r_squares will be calculated for 
each predictor.</p></dd>
<dt>var_trials</dt>
<dd><p>Name of the variable containing the number of trials 
(only for binomial regressions). If a single integer is provided this is
considered to be a the constant number of trials across all measurements.</p></dd>
<dt>dvar_percentage</dt>
<dd><p>Only for binomial distribution. If set TRUE, the 
dependent variable is assumed to represent proportions [0,1]. Otherwise 
dvar is assumed to represent counts.</p></dd>
<dt>...</dt>
<dd><p>Further arguments passed to the glm function.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>formula</dt>
<dd><p>plm formula. Uselful if you want to use the update or 
  formula argument and you don't know the names of the parameters.</p></dd>
<dt>model</dt>
<dd><p>Character string from function call (see <code>Arguments</code> 
  above).</p></dd>
<dt>F.test</dt>
<dd><p>F-test values of modelfit.</p></dd>
<dt>r.squares</dt>
<dd><p>Explained variance R squared for each model parameter.</p></dd>
<dt>ar</dt>
<dd><p>Autoregression lag from function call (see <code>Arguments</code> 
  above).</p></dd>
<dt>family</dt>
<dd><p>Distribution family from function call 
  (see <code>Arguments</code> above).</p></dd>
<dt>full.model</dt>
<dd><p>Full regression model list from the gls or glm function.</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Beretvas, S., &amp; Chung, H. (2008). An evaluation of modified
R2-change effect size indices for single-subject experimental designs.
<em>Evidence-Based Communication Assessment and Intervention, 2</em>, 120-128.</p>
<p>Huitema, B. E., &amp; McKean, J. W. (2000). Design specification issues in
time-series intervention models. <em>Educational and Psychological
Measurement, 60</em>, 38-58.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other regression functions: 
<code><a href="corrected_tau.html">corrected_tau</a>()</code>,
<code><a href="hplm.html">hplm</a>()</code>,
<code><a href="mplm.html">mplm</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Juergen Wilbert</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## Compute a piecewise regression model for a random single-case</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="va">AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span></span>
<span class="r-in">  phase_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, </span>
<span class="r-in">  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0</span>, B <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, </span>
<span class="r-in">  trend <span class="op">=</span> <span class="fl">0.05</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">AB</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, AR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  B&amp;L-B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlated residuals up to autoregressions of lag 3 are modelled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(3, 26) = 47.38; p = 0.000; R² = 0.845; Adjusted R² = 0.828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    B   2.5%  97.5%    SE      t     p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     53.234 47.630 58.838 2.859 18.618 0.000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt      -0.166 -1.032  0.701 0.442 -0.374 0.711  -0.0012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B 15.353  9.550 21.156 2.961  5.185 0.000   0.0735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B  0.913 -0.045  1.871 0.489  1.869 0.073   0.0162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + mt + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Another example with a more complex design</span></span>
<span class="r-in"><span class="va">A1B1A2B2</span> <span class="op">&lt;-</span> <span class="fu"><a href="design.html">design</a></span><span class="op">(</span></span>
<span class="r-in">  phase_design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">15</span>, B1 <span class="op">=</span> <span class="fl">20</span>, A2 <span class="op">=</span> <span class="fl">15</span>, B2 <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, </span>
<span class="r-in">  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">0</span>, B1 <span class="op">=</span> <span class="fl">1</span>, A2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, B2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span class="r-in">  slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A1 <span class="op">=</span> <span class="fl">0</span>, B1 <span class="op">=</span> <span class="fl">0.0</span>, A2 <span class="op">=</span> <span class="fl">0</span>, B2 <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span>
<span class="r-in">  trend <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_scdf.html">random_scdf</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">A1B1A2B2</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, model <span class="op">=</span> <span class="st">"JW"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  JW </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(7, 62) = 11.05; p = 0.000; R² = 0.555; Adjusted R² = 0.505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      B    2.5%  97.5%    SE      t     p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept       51.439  46.427 56.451 2.557 20.115 0.000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt        -0.085  -0.636  0.467 0.281 -0.301 0.764   0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B1   7.536   1.297 13.775 3.183  2.367 0.021   0.0402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase A2 -11.120 -17.517 -4.722 3.264 -3.407 0.001   0.0833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B2  10.261   4.022 16.500 3.183  3.224 0.002   0.0746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B1   0.280  -0.377  0.937 0.335  0.835 0.407   0.0050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase A2  -0.240  -0.897  0.417 0.335 -0.716 0.477   0.0037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B2   0.119  -0.538  0.776 0.335  0.354 0.724   0.0009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + mt + phaseB1 + phaseA2 + phaseB2 + interB1 + interA2 + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     interB2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## no slope effects were found. Therefore you might want to drop slope estimation:</span></span>
<span class="r-in"><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, slope <span class="op">=</span> <span class="cn">FALSE</span>, model <span class="op">=</span> <span class="st">"JW"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  JW </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(4, 65) = 19.73; p = 0.000; R² = 0.548; Adjusted R² = 0.521</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      B    2.5%  97.5%    SE      t     p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept       50.157  47.279 53.035 1.468 34.157 0.000         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt         0.076  -0.133  0.284 0.107  0.710 0.480   0.0035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B1   7.671   2.879 12.463 2.445  3.137 0.003   0.0684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase A2 -10.945 -15.737 -6.153 2.445 -4.477 0.000   0.1392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B2   9.402   4.610 14.194 2.445  3.846 0.000   0.1028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + mt + phaseB1 + phaseA2 + phaseB2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## and now drop the trend estimation as well</span></span>
<span class="r-in"><span class="fu">plm</span><span class="op">(</span><span class="va">dat</span>, slope <span class="op">=</span> <span class="cn">FALSE</span>, trend <span class="op">=</span> <span class="cn">FALSE</span>, model <span class="op">=</span> <span class="st">"JW"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  JW </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a gaussian distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F(3, 66) = 26.34; p = 0.000; R² = 0.545; Adjusted R² = 0.524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     B    2.5%  97.5%    SE      t p delta R²</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept      50.762  48.427 53.097 1.191 42.611 0         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B1  8.995   5.906 12.084 1.576  5.708 0   0.2247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase A2 -9.621 -12.710 -6.532 1.576 -6.105 0   0.2570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B2 10.726   7.637 13.815 1.576  6.806 0   0.3195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Autocorrelations of the residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  lag    cr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 -0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2 -0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3  0.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values ~ 1 + phaseB1 + phaseA2 + phaseB2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A poisson regression</span></span>
<span class="r-in"><span class="va">example_A24</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> </span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year</span> <span class="op">-</span> <span class="va">year</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="op"><a href="pipe.html">%&gt;%</a></span> </span>
<span class="r-in">  <span class="fu">plm</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  B&amp;L-B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a poisson distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X²(3) = 547.67; p = 0.000; AIC = 261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    B   2.5%  97.5%    SE       t     p Odds Ratio    2.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept      5.556  5.472  5.638 0.042 131.693 0.000    258.786 237.936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend year     0.007 -0.016  0.030 0.012   0.604 0.546      1.007   0.984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B -0.801 -0.925 -0.677 0.063 -12.671 0.000      0.449   0.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B -0.006 -0.031  0.019 0.013  -0.472 0.637      0.994   0.969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 97.5% Yule's Q  2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     280.900     0.99  0.99  0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend year      1.030     0.00 -0.01  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B   0.508    -0.38 -0.43 -0.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B   1.019     0.00 -0.02  0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: injuries ~ 1 + year + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A binomial regression (frequencies as dependent variable)</span></span>
<span class="r-in"><span class="fu">plm</span><span class="op">(</span><span class="va">exampleAB_score</span><span class="op">$</span><span class="va">Christiano</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, var_trials <span class="op">=</span> <span class="st">"trials"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  B&amp;L-B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a binomial distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X²(3) = 240.66; p = 0.000; AIC = 120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    B   2.5%  97.5%    SE      t     p Odds Ratio  2.5%  97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     -1.988 -2.944 -1.142 0.456 -4.354 0.000      0.137 0.053  0.319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt       0.023 -0.118  0.166 0.072  0.324 0.746      1.023 0.889  1.181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B  2.338  1.502  3.244 0.442  5.284 0.000     10.360 4.491 25.636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B  0.038 -0.111  0.186 0.075  0.504 0.614      1.039 0.895  1.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Yule's Q  2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept        -0.76 -0.90 -0.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt          0.01 -0.06  0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B     0.82  0.64  0.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B     0.02 -0.06  0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: values/trials ~ 1 + mt + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights =  trials</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A binomial regression (percentage as dependent variable)</span></span>
<span class="r-in"><span class="va">exampleAB_score</span><span class="op">$</span><span class="va">Christiano</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">values</span><span class="op">/</span><span class="va">trials</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="set_vars.html">set_dvar</a></span><span class="op">(</span><span class="st">"percentage"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">plm</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span>, var_trials <span class="op">=</span> <span class="st">"trials"</span>, dvar_percentage <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Piecewise Regression Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dummy model:  B&amp;L-B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted a binomial distribution.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X²(3) = 240.66; p = 0.000; AIC = 120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    B   2.5%  97.5%    SE      t     p Odds Ratio  2.5%  97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept     -1.988 -2.944 -1.142 0.456 -4.354 0.000      0.137 0.053  0.319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt       0.023 -0.118  0.166 0.072  0.324 0.746      1.023 0.889  1.181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B  2.338  1.502  3.244 0.442  5.284 0.000     10.360 4.491 25.636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B  0.038 -0.111  0.186 0.075  0.504 0.614      1.039 0.895  1.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Yule's Q  2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept        -0.76 -0.90 -0.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend mt          0.01 -0.06  0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level phase B     0.82  0.64  0.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope phase B     0.02 -0.06  0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: percentage ~ 1 + mt + phaseB + interB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights =  trials</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Juergen Wilbert, Timo Lueke.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

